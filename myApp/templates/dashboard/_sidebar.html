{% load static %}
<aside id="sidebar"
       class="lg:translate-x-0 -translate-x-full transition-transform duration-200
              bg-white/90 backdrop-blur border-r border-slate-200 min-h-screen sticky top-0 z-40">

  <!-- Brand -->
  <div class="h-16 px-4 flex items-center border-b border-slate-200/80">
    <a href="{% url 'portal_dashboard' %}?section=overview" class="flex items-center gap-3 group">
      {% if request.org and request.org.logo_url %}
        <div class="relative">
          <img src="{{ request.org.logo_url }}" alt="" class="h-8 w-8 rounded-lg object-cover border border-slate-200">
          <span class="absolute -inset-0.5 rounded-xl -z-10 bg-gradient-to-br from-emerald-200/50 to-sky-200/50"></span>
        </div>
      {% else %}
        <div class="h-8 w-8 rounded-lg ring-2 ring-emerald-200" style="background: var(--brand)"></div>
      {% endif %}
      <span class="font-bold tracking-tight hidden md:block">
        {% if request.org %}{{ request.org.name }}{% else %}NeuroMed AI{% endif %}
      </span>
    </a>
  </div>

  {% with a=active_section|default:"overview" %}
  <nav class="p-3 space-y-1">
    <!-- Workspace -->
    <div class="px-2 py-1 text-[11px] uppercase tracking-wide text-slate-500">Workspace</div>

    <a href="{% url 'portal_dashboard' %}?section=overview"
       class="flex items-center gap-3 px-3 py-2.5 rounded-xl
              {% if a == 'overview' %}bg-slate-100 font-semibold text-slate-900
              {% else %}text-slate-700 hover:bg-slate-50{% endif %}"
       aria-current="{% if a == 'overview' %}page{% endif %}">
      <i class="fa-solid fa-gauge-high w-5 text-emerald-700"></i>
      Overview
    </a>

    <a href="{% url 'portal_dashboard' %}?section=clinical"
       class="flex items-center gap-3 px-3 py-2.5 rounded-xl
              {% if a == 'clinical' %}bg-slate-100 font-semibold text-slate-900
              {% else %}text-slate-700 hover:bg-slate-50{% endif %}"
       aria-current="{% if a == 'clinical' %}page{% endif %}">
      <i class="fa-solid fa-stethoscope w-5 text-emerald-700"></i>
      Clinical
    </a>

    <a href="{% url 'portal_dashboard' %}?section=frontdesk"
       class="flex items-center gap-3 px-3 py-2.5 rounded-xl
              {% if a == 'frontdesk' %}bg-slate-100 font-semibold text-slate-900
              {% else %}text-slate-700 hover:bg-slate-50{% endif %}"
       aria-current="{% if a == 'frontdesk' %}page{% endif %}">
      <i class="fa-solid fa-calendar-check w-5 text-sky-700"></i>
      Front Desk
    </a>

    <a href="{% url 'portal_dashboard' %}?section=rcm"
       class="flex items-center gap-3 px-3 py-2.5 rounded-xl
              {% if a == 'rcm' %}bg-slate-100 font-semibold text-slate-900
              {% else %}text-slate-700 hover:bg-slate-50{% endif %}"
       aria-current="{% if a == 'rcm' %}page{% endif %}">
      <i class="fa-solid fa-file-invoice-dollar w-5 text-indigo-700"></i>
      RCM
    </a>

    <a href="{% url 'portal_dashboard' %}?section=admin"
       class="flex items-center gap-3 px-3 py-2.5 rounded-xl
              {% if a == 'admin' %}bg-slate-100 font-semibold text-slate-900
              {% else %}text-slate-700 hover:bg-slate-50{% endif %}"
       aria-current="{% if a == 'admin' %}page{% endif %}">
      <i class="fa-solid fa-gear w-5 text-slate-700"></i>
      Admin
    </a>

    <!-- Apps quick links (always available) -->
    <div class="mt-3 px-2 py-1 text-[11px] uppercase tracking-wide text-slate-500">Apps</div>
    <div class="grid grid-cols-2 gap-2 px-2">
      <a href="{% url 'app_triage' %}" class="rounded-lg border border-slate-200 px-3 py-2 text-sm hover:bg-slate-50">Triage</a>
      <a href="{% url 'app_scribe' %}" class="rounded-lg border border-slate-200 px-3 py-2 text-sm hover:bg-slate-50">Scribe</a>
      <a href="{% url 'app_clinical' %}" class="rounded-lg border border-slate-200 px-3 py-2 text-sm hover:bg-slate-50">Clinical</a>
      <a href="{% url 'app_coding' %}" class="rounded-lg border border-slate-200 px-3 py-2 text-sm hover:bg-slate-50">Coding</a>
    </div>

    {% if request.user.is_staff %}
      <!-- Staff utilities -->
      <div class="mt-4 px-2 py-1 text-[11px] uppercase tracking-wide text-slate-500">Staff</div>
      <a href="{% url 'launch_links' %}"
         class="mx-2 flex items-center gap-3 px-3 py-2.5 rounded-xl text-slate-700 hover:bg-slate-50">
        <i class="fa-solid fa-rocket w-5 text-emerald-700"></i>
        Launch / Kiosk links
      </a>
      <a href="{% url 'analytics' %}"
         class="mx-2 flex items-center gap-3 px-3 py-2.5 rounded-xl text-slate-700 hover:bg-slate-50">
        <i class="fa-solid fa-chart-line w-5 text-emerald-700"></i>
        Website Analytics
      </a>
    {% endif %}
  </nav>
  {% endwith %}

  <!-- Help card -->
  <div class="mt-auto p-4 text-xs text-slate-500">
    <div class="rounded-xl border border-slate-200 p-3 bg-white/80">
      <div class="font-semibold text-slate-700">Need help?</div>
      <p class="mt-1">Email <a class="underline hover:no-underline" href="mailto:support@neuromedai.org">support@neuromedai.org</a></p>
    </div>
  </div>
</aside>
